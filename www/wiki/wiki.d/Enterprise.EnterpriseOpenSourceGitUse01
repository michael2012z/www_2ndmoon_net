version=pmwiki-2.2.6 ordered=1 urlencoded=1
agent=Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.6) Gecko/20100625 Firefox/3.6.6
author=
charset=UTF-8
csum=
ctime=1279167502
host=194.237.142.17
name=Enterprise.EnterpriseOpenSourceGitUse01
rev=2
targets=
text=在Ubuntu 10 上搭建git服务器%0a%0a搭建git服务器有几种方式可选，gitosis是其中最常用的一种。%0a%0a最近新装了ubuntu 10系统，并买了一块飞凌ok6410开发板，准备从零开始移植linux 2.6.28.6的内核，免不了要一步一步地添加和修改文件，所以最好有一个git repository来记录历史。%0a以前也一直用git来管理自己开发的一些软件，但都是最简单的单机方式，只用于做个记录，现在准备尝试一下更复杂也更标准的方式，建一个可以多机协作的，并且有正规的权限管理。\\%0a遇到一番周折，现在把过程详细记录一下。\\%0a总共分下面8个步骤，实施每个步骤的角色不同。%0a%0a步骤0：区分不同角色/用户\\%0a有两个主机，一个名叫fion-laptop (ip: 192.168.0.100)，安装有ubuntu 10，是git server所在的机器，是host端；另一个名叫fion-enc (ip: 192.168.0.101)，主要是windows vista，安装virtual box虚拟机，其上运行ubuntu 9系统，这个系统主要是用来做测试，是remote端。\\%0a在安装过程里，总共有三个角色，分别是：\\%0aroot@fion-laptop  - system root \\%0afion@fion-laptop  - git administrator \\%0agit@fion-laptop   - git repository holder \\%0a其中起主要做用的是fion@fion-laptop，它是git server的管理员。注意，git server管理员不是名字叫git的那个用户。%0a%0a步骤1：安装软件（root@fion-laptop实施）\\%0a安装下面三个软件包：\\%0agit, gitosis, openssh-server\\%0a其中openssh-server的配置文件是/etc/ssh/sshd_config，如果有修改的话，记得重启sshd服务：\\%0a/etc/init.d/ssh restart%0a%0a步骤2：建立git用户（root@fion-laptop实施）\\%0aadduser git%0a%0a步骤3: 生成管理员密钥对（fion@fion-laptop实施）\\%0a通过下面的命令生成密钥对\\%0assh-keygen -t rsa \\%0a刚刚生成的密钥放在~/.ssh目录下，其中id_rsa.pub是公钥，id_rsa是私钥。\\%0a公钥稍后需要给git用户使用，所以把它拷贝一份到/tmp目录下。%0a%0a步骤4: 建立git仓库（git@fion-laptop实施）\\%0a登录git用户，回到自己的/home/git目录下，从/tmp目录拷贝fion的公钥id_rsa.pub。\\%0a运行下面命令：\\%0agitosis-init %3c id_rsa.pub \\%0a生成两个目录：gitosis 和 repositories，后者即是git仓库所在位置。一个基本的仓库已经建立起来，下面需要做的全都是git管理员的配置工作。\\%0a生成repositories用的公钥是fion用户的，所以，现在fion已经是git仓库的管理员。%0a%0a%0a步骤5: 配置git server（fion@fion-laptop实施）\\%0agitosis的配置方式很特别，repository的配置文件本身也是一个repository，名字是gitosis-admin.git。git administrator需要把它clone一份到本地，然后修改和commit，当push回去的时候，新的配置就生效。\\%0a首先，已经是git administrator的fion用户运行：\\%0agit clone git@fion-laptop:gitosis-admin.git \\%0a在得到的gitosis-admin目录下有一个文本文件gitosis.conf和一个空目录keydir。\\%0agitosis.conf里记录了repositories里的每一个group以及每个成员的权限，一个group就是一个repository。\\%0a比如我准备建立一个叫作ok6410的repository，就在gitosis.conf里添加以下内容：\\%0a[group ok6410] \\%0awritable = ok6410 \\%0amembers = fion@fion-laptop root@fion-laptop root@fion-enc \\%0a这里，我为ok6410这个repository设置了三个用户，一个是git的管理员，另外两个分别是fion-laptop和fion-enc两个主机上的root用户，这主要是因为我一般习惯于直接登录根用户来工作，当然这样比较危险，最好不要这样。\\%0a接下来要准备这三个用户的公钥。让他们分别通过ssh-keygen -t rsa生成自己的密钥对，并设法把公钥拷贝到keydir目录下，分别重命名为fion@fion-laptop.pub root@fion-laptop.pub root@fion-enc.pub%0a%0a步骤6：创建新的repository（fion@fion-laptop实施）\\%0a依次通过以下命令来创建一个新的repository，即上面配置过的ok6410。\\%0amkdir ok6410 \\%0acd ok6410 \\%0agit init \\%0agit remote add origin git@fion-laptop:ok6410.git \\%0a...prepare some source code ... \\%0agit add . \\%0agit commit -a \\%0agit push origin master:refs/heads/master%0a%0a步骤7：测试（root@fion-enc）\\%0a在测试主机上尝试clone：\\%0agit clone git@192.168.0.100:ok6410.git \\%0a成功。\\%0a修改并commit、push，都成功。%0a%0a注意事项：\\%0a在配置过程中遇到了几个问题，耽误了好些时间。强调一下，帮助其他人少走弯路：\\%0a1.步骤5中，配置文件中member的名字结构是name@host，其中host一定得是文本地址，不能直接用ip地址。可以在/etc/hosts里设置ip地址与主机名的对应。比如root@192.168.0.101，这样设置的话，它对应的公钥文件名字必然是root@192.168.0.101.pub，这个文件在push的时候会被警告。而且这名用户将无法clone成功。\\%0a2.还是与步骤5有关。一开始，我的测试用主机（virtual box虚拟机）的虚拟网卡是采用的NAT方式，所以我把member设置为root@[vista主机IP]，因为我想git server看到的地址一定是vista主机的地址。但这样也不行，clone失败。最后我把虚拟网卡改成桥接方式，git server能直接看到虚拟机的IP，这样就成功了。\\%0a3.步骤6中，新创建的repository不能是空的，push的时候会报错，要多少放一点东西进去，哪怕是touch一个空文件。%0a
time=1279167624
author:1279167624=
diff:1279167624:1279167502:=6,7c6,7%0a%3c 以前也一直用git来管理自己开发的一些软件，但都是最简单的单机方式，只用于做个记录，现在准备尝试一下更复杂也更标准的方式，建一个可以多机协作的，并且有正规的权限管理。\\%0a%3c 遇到一番周折，现在把过程详细记录一下。\\%0a---%0a> 以前也一直用git来管理自己开发的一些软件，但都是最简单的单机方式，只用于做个记录，现在准备尝试一下更复杂也更标准的方式，建一个可以多机协作的，并且有正规的权限管理。%0a> 遇到一番周折，现在把过程详细记录一下。%0a10,15c10,15%0a%3c 步骤0：区分不同角色/用户\\%0a%3c 有两个主机，一个名叫fion-laptop (ip: 192.168.0.100)，安装有ubuntu 10，是git server所在的机器，是host端；另一个名叫fion-enc (ip: 192.168.0.101)，主要是windows vista，安装virtual box虚拟机，其上运行ubuntu 9系统，这个系统主要是用来做测试，是remote端。\\%0a%3c 在安装过程里，总共有三个角色，分别是：\\%0a%3c root@fion-laptop  - system root \\%0a%3c fion@fion-laptop  - git administrator \\%0a%3c git@fion-laptop   - git repository holder \\%0a---%0a> 步骤0：区分不同角色/用户%0a> 有两个主机，一个名叫fion-laptop (ip: 192.168.0.100)，安装有ubuntu 10，是git server所在的机器，是host端；另一个名叫fion-enc (ip: 192.168.0.101)，主要是windows vista，安装virtual box虚拟机，其上运行ubuntu 9系统，这个系统主要是用来做测试，是remote端。%0a> 在安装过程里，总共有三个角色，分别是：%0a> root@fion-laptop  - system root%0a> fion@fion-laptop  - git administrator%0a> git@fion-laptop   - git repository holder%0a18,21c18,21%0a%3c 步骤1：安装软件（root@fion-laptop实施）\\%0a%3c 安装下面三个软件包：\\%0a%3c git, gitosis, openssh-server\\%0a%3c 其中openssh-server的配置文件是/etc/ssh/sshd_config，如果有修改的话，记得重启sshd服务：\\%0a---%0a> 步骤1：安装软件（root@fion-laptop实施）%0a> 安装下面三个软件包：%0a> git, gitosis, openssh-server%0a> 其中openssh-server的配置文件是/etc/ssh/sshd_config，如果有修改的话，记得重启sshd服务：%0a24c24%0a%3c 步骤2：建立git用户（root@fion-laptop实施）\\%0a---%0a> 步骤2：建立git用户（root@fion-laptop实施）%0a27,30c27,30%0a%3c 步骤3: 生成管理员密钥对（fion@fion-laptop实施）\\%0a%3c 通过下面的命令生成密钥对\\%0a%3c ssh-keygen -t rsa \\%0a%3c 刚刚生成的密钥放在~/.ssh目录下，其中id_rsa.pub是公钥，id_rsa是私钥。\\%0a---%0a> 步骤3: 生成管理员密钥对（fion@fion-laptop实施）%0a> 通过下面的命令生成密钥对%0a> ssh-keygen -t rsa%0a> 刚刚生成的密钥放在~/.ssh目录下，其中id_rsa.pub是公钥，id_rsa是私钥。%0a33,37c33,37%0a%3c 步骤4: 建立git仓库（git@fion-laptop实施）\\%0a%3c 登录git用户，回到自己的/home/git目录下，从/tmp目录拷贝fion的公钥id_rsa.pub。\\%0a%3c 运行下面命令：\\%0a%3c gitosis-init %3c id_rsa.pub \\%0a%3c 生成两个目录：gitosis 和 repositories，后者即是git仓库所在位置。一个基本的仓库已经建立起来，下面需要做的全都是git管理员的配置工作。\\%0a---%0a> 步骤4: 建立git仓库（git@fion-laptop实施）%0a> 登录git用户，回到自己的/home/git目录下，从/tmp目录拷贝fion的公钥id_rsa.pub。%0a> 运行下面命令：%0a> gitosis-init %3c id_rsa.pub%0a> 生成两个目录：gitosis 和 repositories，后者即是git仓库所在位置。一个基本的仓库已经建立起来，下面需要做的全都是git管理员的配置工作。%0a41,51c41,51%0a%3c 步骤5: 配置git server（fion@fion-laptop实施）\\%0a%3c gitosis的配置方式很特别，repository的配置文件本身也是一个repository，名字是gitosis-admin.git。git administrator需要把它clone一份到本地，然后修改和commit，当push回去的时候，新的配置就生效。\\%0a%3c 首先，已经是git administrator的fion用户运行：\\%0a%3c git clone git@fion-laptop:gitosis-admin.git \\%0a%3c 在得到的gitosis-admin目录下有一个文本文件gitosis.conf和一个空目录keydir。\\%0a%3c gitosis.conf里记录了repositories里的每一个group以及每个成员的权限，一个group就是一个repository。\\%0a%3c 比如我准备建立一个叫作ok6410的repository，就在gitosis.conf里添加以下内容：\\%0a%3c [group ok6410] \\%0a%3c writable = ok6410 \\%0a%3c members = fion@fion-laptop root@fion-laptop root@fion-enc \\%0a%3c 这里，我为ok6410这个repository设置了三个用户，一个是git的管理员，另外两个分别是fion-laptop和fion-enc两个主机上的root用户，这主要是因为我一般习惯于直接登录根用户来工作，当然这样比较危险，最好不要这样。\\%0a---%0a> 步骤5: 配置git server（fion@fion-laptop实施）%0a> gitosis的配置方式很特别，repository的配置文件本身也是一个repository，名字是gitosis-admin.git。git administrator需要把它clone一份到本地，然后修改和commit，当push回去的时候，新的配置就生效。%0a> 首先，已经是git administrator的fion用户运行：%0a> git clone git@fion-laptop:gitosis-admin.git%0a> 在得到的gitosis-admin目录下有一个文本文件gitosis.conf和一个空目录keydir。%0a> gitosis.conf里记录了repositories里的每一个group以及每个成员的权限，一个group就是一个repository。%0a> 比如我准备建立一个叫作ok6410的repository，就在gitosis.conf里添加以下内容：%0a> [group ok6410]%0a> writable = ok6410%0a> members = fion@fion-laptop root@fion-laptop root@fion-enc%0a> 这里，我为ok6410这个repository设置了三个用户，一个是git的管理员，另外两个分别是fion-laptop和fion-enc两个主机上的root用户，这主要是因为我一般习惯于直接登录根用户来工作，当然这样比较危险，最好不要这样。%0a54,62c54,62%0a%3c 步骤6：创建新的repository（fion@fion-laptop实施）\\%0a%3c 依次通过以下命令来创建一个新的repository，即上面配置过的ok6410。\\%0a%3c mkdir ok6410 \\%0a%3c cd ok6410 \\%0a%3c git init \\%0a%3c git remote add origin git@fion-laptop:ok6410.git \\%0a%3c ...prepare some source code ... \\%0a%3c git add . \\%0a%3c git commit -a \\%0a---%0a> 步骤6：创建新的repository（fion@fion-laptop实施）%0a> 依次通过以下命令来创建一个新的repository，即上面配置过的ok6410。%0a> mkdir ok6410%0a> cd ok6410%0a> git init%0a> git remote add origin git@fion-laptop:ok6410.git%0a> ...prepare some source code ...%0a> git add .%0a> git commit -a%0a65,68c65,68%0a%3c 步骤7：测试（root@fion-enc）\\%0a%3c 在测试主机上尝试clone：\\%0a%3c git clone git@192.168.0.100:ok6410.git \\%0a%3c 成功。\\%0a---%0a> 步骤7：测试（root@fion-enc）%0a> 在测试主机上尝试clone：%0a> git clone git@192.168.0.100:ok6410.git%0a> 成功。%0a71,75c71,75%0a%3c 注意事项：\\%0a%3c 在配置过程中遇到了几个问题，耽误了好些时间。强调一下，帮助其他人少走弯路：\\%0a%3c 1.步骤5中，配置文件中member的名字结构是name@host，其中host一定得是文本地址，不能直接用ip地址。可以在/etc/hosts里设置ip地址与主机名的对应。比如root@192.168.0.101，这样设置的话，它对应的公钥文件名字必然是root@192.168.0.101.pub，这个文件在push的时候会被警告。而且这名用户将无法clone成功。\\%0a%3c 2.还是与步骤5有关。一开始，我的测试用主机（virtual box虚拟机）的虚拟网卡是采用的NAT方式，所以我把member设置为root@[vista主机IP]，因为我想git server看到的地址一定是vista主机的地址。但这样也不行，clone失败。最后我把虚拟网卡改成桥接方式，git server能直接看到虚拟机的IP，这样就成功了。\\%0a%3c 3.步骤6中，新创建的repository不能是空的，push的时候会报错，要多少放一点东西进去，哪怕是touch一个空文件。%0a---%0a> 注意事项：%0a> 在配置过程中遇到了几个问题，耽误了好些时间。强调一下，帮助其他人少走弯路：%0a> 1.步骤5中，配置文件中member的名字结构是name@host，其中host一定得是文本地址，不能直接用ip地址。可以在/etc/hosts里设置ip地址与主机名的对应。比如root@192.168.0.101，这样设置的话，它对应的公钥文件名字必然是root@192.168.0.101.pub，这个文件在push的时候会被警告。而且这名用户将无法clone成功。%0a> 2.还是与步骤5有关。一开始，我的测试用主机（virtual box虚拟机）的虚拟网卡是采用的NAT方式，所以我把member设置为root@[vista主机IP]，因为我想git server看到的地址一定是vista主机的地址。但这样也不行，clone失败。最后我把虚拟网卡改成桥接方式，git server能直接看到虚拟机的IP，这样就成功了。%0a> 3.步骤6中，新创建的repository不能是空的，push的时候会报错，要多少放一点东西进去，哪怕是touch一个空文件。%0a\ No newline at end of file%0a
host:1279167624=194.237.142.17
author:1279167502=
diff:1279167502:1279167502:=1,75d0%0a%3c 在Ubuntu 10 上搭建git服务器%0a%3c %0a%3c 搭建git服务器有几种方式可选，gitosis是其中最常用的一种。%0a%3c %0a%3c 最近新装了ubuntu 10系统，并买了一块飞凌ok6410开发板，准备从零开始移植linux 2.6.28.6的内核，免不了要一步一步地添加和修改文件，所以最好有一个git repository来记录历史。%0a%3c 以前也一直用git来管理自己开发的一些软件，但都是最简单的单机方式，只用于做个记录，现在准备尝试一下更复杂也更标准的方式，建一个可以多机协作的，并且有正规的权限管理。%0a%3c 遇到一番周折，现在把过程详细记录一下。%0a%3c 总共分下面8个步骤，实施每个步骤的角色不同。%0a%3c %0a%3c 步骤0：区分不同角色/用户%0a%3c 有两个主机，一个名叫fion-laptop (ip: 192.168.0.100)，安装有ubuntu 10，是git server所在的机器，是host端；另一个名叫fion-enc (ip: 192.168.0.101)，主要是windows vista，安装virtual box虚拟机，其上运行ubuntu 9系统，这个系统主要是用来做测试，是remote端。%0a%3c 在安装过程里，总共有三个角色，分别是：%0a%3c root@fion-laptop  - system root%0a%3c fion@fion-laptop  - git administrator%0a%3c git@fion-laptop   - git repository holder%0a%3c 其中起主要做用的是fion@fion-laptop，它是git server的管理员。注意，git server管理员不是名字叫git的那个用户。%0a%3c %0a%3c 步骤1：安装软件（root@fion-laptop实施）%0a%3c 安装下面三个软件包：%0a%3c git, gitosis, openssh-server%0a%3c 其中openssh-server的配置文件是/etc/ssh/sshd_config，如果有修改的话，记得重启sshd服务：%0a%3c /etc/init.d/ssh restart%0a%3c %0a%3c 步骤2：建立git用户（root@fion-laptop实施）%0a%3c adduser git%0a%3c %0a%3c 步骤3: 生成管理员密钥对（fion@fion-laptop实施）%0a%3c 通过下面的命令生成密钥对%0a%3c ssh-keygen -t rsa%0a%3c 刚刚生成的密钥放在~/.ssh目录下，其中id_rsa.pub是公钥，id_rsa是私钥。%0a%3c 公钥稍后需要给git用户使用，所以把它拷贝一份到/tmp目录下。%0a%3c %0a%3c 步骤4: 建立git仓库（git@fion-laptop实施）%0a%3c 登录git用户，回到自己的/home/git目录下，从/tmp目录拷贝fion的公钥id_rsa.pub。%0a%3c 运行下面命令：%0a%3c gitosis-init %3c id_rsa.pub%0a%3c 生成两个目录：gitosis 和 repositories，后者即是git仓库所在位置。一个基本的仓库已经建立起来，下面需要做的全都是git管理员的配置工作。%0a%3c 生成repositories用的公钥是fion用户的，所以，现在fion已经是git仓库的管理员。%0a%3c %0a%3c %0a%3c 步骤5: 配置git server（fion@fion-laptop实施）%0a%3c gitosis的配置方式很特别，repository的配置文件本身也是一个repository，名字是gitosis-admin.git。git administrator需要把它clone一份到本地，然后修改和commit，当push回去的时候，新的配置就生效。%0a%3c 首先，已经是git administrator的fion用户运行：%0a%3c git clone git@fion-laptop:gitosis-admin.git%0a%3c 在得到的gitosis-admin目录下有一个文本文件gitosis.conf和一个空目录keydir。%0a%3c gitosis.conf里记录了repositories里的每一个group以及每个成员的权限，一个group就是一个repository。%0a%3c 比如我准备建立一个叫作ok6410的repository，就在gitosis.conf里添加以下内容：%0a%3c [group ok6410]%0a%3c writable = ok6410%0a%3c members = fion@fion-laptop root@fion-laptop root@fion-enc%0a%3c 这里，我为ok6410这个repository设置了三个用户，一个是git的管理员，另外两个分别是fion-laptop和fion-enc两个主机上的root用户，这主要是因为我一般习惯于直接登录根用户来工作，当然这样比较危险，最好不要这样。%0a%3c 接下来要准备这三个用户的公钥。让他们分别通过ssh-keygen -t rsa生成自己的密钥对，并设法把公钥拷贝到keydir目录下，分别重命名为fion@fion-laptop.pub root@fion-laptop.pub root@fion-enc.pub%0a%3c %0a%3c 步骤6：创建新的repository（fion@fion-laptop实施）%0a%3c 依次通过以下命令来创建一个新的repository，即上面配置过的ok6410。%0a%3c mkdir ok6410%0a%3c cd ok6410%0a%3c git init%0a%3c git remote add origin git@fion-laptop:ok6410.git%0a%3c ...prepare some source code ...%0a%3c git add .%0a%3c git commit -a%0a%3c git push origin master:refs/heads/master%0a%3c %0a%3c 步骤7：测试（root@fion-enc）%0a%3c 在测试主机上尝试clone：%0a%3c git clone git@192.168.0.100:ok6410.git%0a%3c 成功。%0a%3c 修改并commit、push，都成功。%0a%3c %0a%3c 注意事项：%0a%3c 在配置过程中遇到了几个问题，耽误了好些时间。强调一下，帮助其他人少走弯路：%0a%3c 1.步骤5中，配置文件中member的名字结构是name@host，其中host一定得是文本地址，不能直接用ip地址。可以在/etc/hosts里设置ip地址与主机名的对应。比如root@192.168.0.101，这样设置的话，它对应的公钥文件名字必然是root@192.168.0.101.pub，这个文件在push的时候会被警告。而且这名用户将无法clone成功。%0a%3c 2.还是与步骤5有关。一开始，我的测试用主机（virtual box虚拟机）的虚拟网卡是采用的NAT方式，所以我把member设置为root@[vista主机IP]，因为我想git server看到的地址一定是vista主机的地址。但这样也不行，clone失败。最后我把虚拟网卡改成桥接方式，git server能直接看到虚拟机的IP，这样就成功了。%0a%3c 3.步骤6中，新创建的repository不能是空的，push的时候会报错，要多少放一点东西进去，哪怕是touch一个空文件。%0a\ No newline at end of file%0a
host:1279167502=194.237.142.17
